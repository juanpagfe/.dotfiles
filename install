#!/bin/zsh

#Install dependencies
if  command -v yum >/dev/null; then
    sudo yum -y install rsync git ripgrep
fi

if command -v apt-get >/dev/null; then
    sudo apt-get install rsync avahi-utils dnsutils net-tools ripgrep fzf
fi

if command -v brew >/dev/null; then
    brew install rsync xclip ffmpeg ripgrep 
fi

#Configure
if [ ! -d ~/.config ]; then
    mkdir ~/.config
fi
cp -r .config/* ~/.config


#Copy bin
if [ ! -d ~/.local ]; then
    mkdir ~/.local
fi
cp -r .local/bin/* ~/.local/bin

#Merge environment files
if [ ! -f envrc ]; then
    echo "Generating envrc file"
    if [ -f /tmp/envrc ]; then
        sudo rm /tmp/envrc
    fi
    touch /tmp/envrc
    cat env/*.sh > /tmp/envrc
fi

#Install environment files
if [ -f envrc ]; then
    sudo mv envrc /etc/envrc
else
    sudo mv /tmp/envrc /etc/envrc
fi
exec zsh -l
echo "Installation completed"
